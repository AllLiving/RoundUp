<center>

### 传感器课程实践web端综述

</center>

#### 整体系统架构

&emsp;&emsp;车联网将先进的通信技术应用于交通系统，利用车车、车路、路路之间的通信为用户提供多种类型的服务，极大地推动了智能交通系统的快速发展。在车联网众多技术中，web端负责提供车队管理系统的相关信息管理，包括车辆实时位置的展示、车辆行程的管理，以及车辆加油信息的调取和展示等等，对车联网的服务性能有着重要影响。

##### 数据收集与修改

&emsp;&emsp;数据的收集与修改功能大多用于从web端进行数据库的添加与修改操作，这种设计的结构保证了管理者可以从物理边界之外的位置获得访问和修改数据库的权限，增强了整个信息储存系统与管理系统的无区别访问性与高可用性。

```flow
user=>start: User
oil=>operation: Databse
bck=>operation: webBack
fore=>operation: webFore

user->fore->bck
bck(right)->oil
```

&emsp;&emsp;web端提供了对数据库信息进行增加、修改的功能，信息的流向是从用户到后端数据库。用户使用web前端传入数据，前端通过通信接口与后端进行交互，并通过权限的过滤实现后端数据库的增加、修改操作，同时返回相关的响应信息，告知用户是否操作成功。

##### 数据搜索与查询

&emsp;&emsp;第二种信息流向，从后端数据库到用户，这种信息流向多满足客户端向服务器发送请求以获取查询信息的需求。因为所实现的车队管理系统需要管理多个车队的信息，而每一个车队中又有许多的车辆信息，这些信息交错复杂，需要使用数据库用于管理。此时为了满足用户的查询需求，同时也是为了保证数据的保密性和安全性，需要通过前端与后端的交互，实现信息的传递，必要时可以对数据进行一定的加密。

```flow
user=>end: User
oil=>operation: OilStation
bck=>operation: webBack
fore=>operation: webFore
db=>operation: Database

db(right)->bck
bck->fore->user

```

&emsp;&emsp;web端提供查询数据库架构的功能，信息的流向是从web后端数据库到用户。用户使用web前端发出请求消息，前端通过通信接口与后端进行交互，并通过权限的过滤实现后端数据库的查询与反馈操作，用户不能在前端页面直接进行查询操作，数据库信息只能由后端代码进行访问，这种设计保护了数据库的保密性与安全性，避免数据库的相关权限信息外泄。

#### 数据库设计

&emsp;&emsp;后端需要管理车队的信息、车队中车辆的信息、路线信息、维护信息、历史路径信息、加油信息以及车队使用人员的信息，这里以加油信息为例，展示出加油信息向车队后端传递的ER图表示：

<center>

<img width="490" src="https://imgsa.baidu.com/forum/pic/item/66fe7387e950352a9ce846d75843fbf2b3118b75.jpg" />

</center>

&emsp;&emsp;由上图可知，对于加油信息而言，需要为已有的成员信息设计关系模式，并且为关系模式设计独立的表格，以保证信息的完整性和可回溯性。

&emsp;&emsp;以上的设计架构需要同时应用到所有的操作中，即需要作用到路线信息、维护信息以及历史路径信息中，以维护数据库系统的正常运行。

&emsp;&emsp;而对整个web后端数据库而言，需要考虑以下因素：

1. 使用者or管理者
2. 车队信息
3. 车辆信息

对应的关系则有如下几种，结合上文的解释需要为以下的关系构建关系模式：

1. 路线关系
2. 运维关系
3. 加油关系
4. 历史路线关系（类似于路线关系）

其中user作为一个独立的表格，而其他的信息则是互相关联的，整体ER图如下：

<center>

<img width="490" src="https://imgsa.baidu.com/forum/pic/item/2e860e10b912c8fc7357a912f7039245d7882152.jpg" />

</center>

*对于每一个关系模式，其中的具体属性值都没有表示出来。*

#### 前端架构





#### 后端架构

&emsp;&emsp;后端所做的主要工作目前是为前端实现做准备工作，服务前端的信息需求，同时维护一些数据信息，这些信息将会用于web前端的查询以及与其他后端的信息交互。

&emsp;&emsp;后端基于Ubuntu server开发环境，使用MySQL搭建数据库，存储整个车队管理系统的相关信息，并进行日常管理维护；使用Node搭建Web服务器，服务器与前端的交互主要通过Http协议，以及Json格式的数据，利用Node.js的非阻塞以及事件驱动特性实现高并发的运作效果，并在有需要的时候访问数据库。

```flow
stt=>start: Start
io=>inputoutput: io
webBack=>condition: 是否需要
访问数据库？
sub=>subroutine: 搭建web服务器
环境：Ubuntu Server
协议： Http
语言：JavaScript
机制：Node.js
op1=>operation: Node.js访问数据库
op2=>operation: 直接与前端进行交互

stt->sub
sub->webBack
webBack(yes, left)->op1
webBack(no, right)->op2
```

*Node.js的优势*：

1. 相比于FriendFeed（FriendFeed是用基于Python的**非阻塞**框架Tornado来实现非阻塞和事件驱动的），Node.js对Web请求的处理更加高效，非阻塞和事件驱动的特性更加显著。Node.js是基于JavaScript开发的，直接在Google的V8引擎上跑，而且V8引擎并不仅限于在一个浏览器中运行，您可以下载该引擎并将其嵌入任何应用程序。用了Node.js，完全不用担心用户端的请求会在服务器里跑了一段能够造成阻塞的代码,因为JavaScript专注于事件处理和回调函数，是给事件处理量身定制的语言。[^1]
2. Node.js非阻塞模式的IO处理给Node.js带来在相对低系统资源耗用下的高性能与出众的负载能力，Node.js宣称，运行它的服务器能支持数万个并发连接,因此非常适合用作依赖其它IO资源的中间层服务。
3. Node.js轻量高效，可以认为是数据密集型分布式部署环境下的实时应用系统的完美解决方案。Node非常适合如下情况：在响应客户端之前，您预计可能有很高的流量，但所需的服务器端逻辑和处理不一定很多。

#### 前后端通信流程

&emsp;&emsp;前后端之间的交互使用的是Http协议，主要使用post方法进行数据的请求与获取，并且数据的传输使用Json格式进行封装。前端根据用户的操作传递相应的参数给后端服务器，后端会根据前端所传输的参数，对数据库进行相应操作，并返回相关的信息。

```sequence
browser->server: request resource A
Note right of server: find  
server->browser: response A
note left of browser: user search
browser->server: search query
note right of server: Node.js/database
server->browser: response query ans
```

对于上图的解释是：

1. 客户端向服务器发送请求消息；
2. 服务器根据客户端的请求返回消息；
3. 当客户端接收到用户的请需要查询数据库内部的信息的时候，发送对应的请求；
4. 服务器接收到来自客户端的请求，Node.js对数据库进行相关操作；
5. 操作结果作为响应，以Json数据格式的形式返回给前端，实现数据的传输；

#### 小组成员

##### web前端成员

| 姓名           | 学号       | 姓名   | 学号       |
| ------------ | -------- | ---- | -------- |
| 王宇轩(captain) | 15352323 | 游志鹏  | 15352393 |
| 王静           | 15352316 | 纪香羽  | 15352145 |
| 王宾骆          | 15352316 | 黄晓琳  | 15352140 |
| 吴佳莹          | 15352335 | 蒋阳   | 15352149 |
| 张春田          | 14353386 | 赖萍萍  | 15352154 |
| 杨子坤          | 15352389 | 黎美云  | 15352159 |
| 许泽鑫          | 15352368 | 原艺童  | 15352397 |

##### web后端成员

| 曹广杰      | 15352015 |
| -------- | -------- |
| 文永明（组长）  | 15352329 |
| 王月庭      | 15352325 |
| *吴灿豪     | 15352331 |
| *肖楚铭（组长） | 15352352 |
| *肖想      | 15352354 |
| 谢烘       | 15352355 |
| 吴伟翀      | 15352343 |

**`*`标注出贡献较大的同学。**

[^1]: 作者：厂长链接：https://www.zhihu.com/question/33578075/answer/56951771